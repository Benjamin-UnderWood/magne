magne
=======

1.进程worker
-------------

代码上比celery更简单~~~


2.进程带线程worker
-------------------


3.协程consumer
-----------------

3.1 配置高低水位
++++++++++++++++++++

高低水位是为了限制就绪任务的总数, 否则cpu会被吃完



3.2 多个进程
+++++++++++++



总结
========

协程更有效率, 因为协程创建开销很低, 也就是一个函数, 然后用户态自己调度协程, 调度的开销也很低, 但是相应的, cpu会高挺多的, 这是因为用户代码调度切换协程的关系

现在python的异步io的难点在于工具不多:

1. 比如magne, 你的每一个task必须适应于curio, 比如sleep必须是curio.sleep等等, 否则consumer都不会yield, 这样就失去了协程的优势, 

2. 又比如如果写一个协程http服务器, 那么如果业务的view不能yield的话, 协程服务器并没有什么意义, 因为不yield的话就是卡在一个request上

   如果需要业务的view能够yield的话, 必须配套有比如reids, mysql这些异步工具,　然而现在并没有, 现在社区还是处于构建协程调度库(curio, asyncio, trio等等)状态


dramatiq的线程模型是真的快, 而且方便, 不需要有其他的定制(比如magne, 你的task必须适应curio), 是由os来调度~~~

celery是多进程的模式, 受限于不能多开进程~~~


